WARNING:tensorflow:From /home/hp200266/u01036/gzq/fj_software/tensorflow/TensorFlow-2.2.0/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
OMP: Warning #181: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined
WARNING:tensorflow:From /home/hp200266/u01036/gzq/fj_software/tensorflow/TensorFlow-2.2.0/lib/python3.8/site-packages/tensorflow/python/profiler/internal/flops_registry.py:142: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
DEEPMD WARNING From /home/hp200266/u01036/gzq/fj_software/tensorflow/TensorFlow-2.2.0/lib/python3.8/site-packages/tensorflow/python/profiler/internal/flops_registry.py:142: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
73 ops no flops stats due to incomplete shapes.
DEEPMD INFO    # ---------------output of dp test--------------- 
DEEPMD INFO    # testing system : ../data/data_3
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Parsing Inputs...
generating trace file.

******************************************************
Timeline file is written to ./profiler.json_0.
Open a Chrome browser, enter URL chrome://tracing and load the timeline file.
******************************************************
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.

=========================Options=============================
-max_depth                  10
-min_bytes                  0
-min_peak_bytes             0
-min_residual_bytes         0
-min_output_bytes           0
-min_micros                 0
-min_accelerator_micros     0
-min_cpu_micros             0
-min_params                 0
-min_float_ops              0
-min_occurrence             0
-step                       -1
-order_by                   micros
-account_type_regexes       .*
-start_name_regexes         .*
-trim_name_regexes          
-show_name_regexes          .*
-hide_name_regexes          
-account_displayed_op_only  false
-select                     bytes,float_ops,micros,occurrence
-output                     stdout:

==================Model Analysis Report======================

Doc:
op: The nodes are operation kernel type, such as MatMul, Conv2D. Graph nodes belonging to the same type are aggregated together.
requested bytes: The memory requested by the operation, accumulatively.
flops: Number of float operations. Note: Please read the implementation for the math behind it.
total execution time: Sum of accelerator execution time and cpu execution time.
cpu execution time: The time from the start to the end of the operation. It's the sum of actual cpu run time plus the time that it spends waiting if part of computation is launched asynchronously.
accelerator execution time: Time spent executing on the accelerator. This is normally measured by the actual hardware library.
occurrence: The number of times it occurs

Profile:
node name | requested bytes | total execution time | accelerator execution time | cpu execution time | # float_ops | op occurrence (run|defined)
TabulateFusionGrad              1.06MB (100.00%, 1.25%),      18.68ms (100.00%, 32.52%),             0us (0.00%, 0.00%),      18.68ms (100.00%, 32.52%),   0 float_ops (100.00%, 0.00%),        4|4
ProdEnvMatA                      4.13MB (98.75%, 4.88%),        9.60ms (67.48%, 16.72%),             0us (0.00%, 0.00%),        9.60ms (67.48%, 16.72%),   0 float_ops (100.00%, 0.00%),        1|1
MatmulNt                         4.25MB (93.86%, 5.02%),        7.15ms (50.76%, 12.45%),             0us (0.00%, 0.00%),        7.15ms (50.76%, 12.45%),   0 float_ops (100.00%, 0.00%),        8|8
GemmTanhLayer                    1.11MB (88.84%, 1.31%),        5.97ms (38.31%, 10.39%),             0us (0.00%, 0.00%),        5.97ms (38.31%, 10.39%),   0 float_ops (100.00%, 0.00%),        6|6
TabulateFusion                   1.57MB (87.53%, 1.86%),         4.45ms (27.91%, 7.74%),             0us (0.00%, 0.00%),         4.45ms (27.91%, 7.74%),   0 float_ops (100.00%, 0.00%),        4|4
BatchMatMulV2                    4.03MB (85.67%, 4.76%),         2.53ms (20.17%, 4.41%),             0us (0.00%, 0.00%),         2.53ms (20.17%, 4.41%), 106.95m float_ops (100.00%, 98.52%),        6|6
ProdVirialSeA                   13.90KB (80.91%, 0.02%),         1.85ms (15.76%, 3.22%),             0us (0.00%, 0.00%),         1.85ms (15.76%, 3.22%),     0 float_ops (1.48%, 0.00%),        1|1
Pad                            11.32MB (80.89%, 13.37%),         1.50ms (12.53%, 2.61%),             0us (0.00%, 0.00%),         1.50ms (12.53%, 2.61%),     0 float_ops (1.48%, 0.00%),      14|14
Slice                            8.30MB (67.52%, 9.81%),          1.42ms (9.92%, 2.48%),             0us (0.00%, 0.00%),          1.42ms (9.92%, 2.48%),     0 float_ops (1.48%, 0.00%),      18|18
ProdForceSeA                     4.61KB (57.71%, 0.01%),           838us (7.44%, 1.46%),             0us (0.00%, 0.00%),           838us (7.44%, 1.46%),     0 float_ops (1.48%, 0.00%),        1|1
AddN                                  0B (0.00%, 0.00%),           759us (5.99%, 1.32%),             0us (0.00%, 0.00%),           759us (5.99%, 1.32%), 809.47k float_ops (1.48%, 0.75%),      14|14

======================End of Report==========================
DEEPMD INFO    # number of test data : 1 
DEEPMD INFO    Energy RMSE        : 6.076734e-02 eV
DEEPMD INFO    Energy RMSE/Natoms : 3.164966e-04 eV
DEEPMD INFO    Force  RMSE        : 6.465624e-02 eV/A
DEEPMD INFO    Virial RMSE        : 5.265184e+00 eV
DEEPMD INFO    Virial RMSE/Natoms : 2.742283e-02 eV
DEEPMD INFO    # ----------------------------------------------- 
profile : ture
dp model type : ener
OMP: Warning #181: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined
INFO: You are running LIKWID in a cpuset with 50 CPUs. Taking given IDs as logical ID in cpuset
[1;34m[likwid-pin] Main PID -> hwthread 12 - OK[0m

Top k op
average time	min time	max time	percentage	op name
 9602.00	    9602	    9602	    0.17	load/ProdEnvMatA
 8112.00	    8112	    8112	    0.14	load/gradients/filter_type_1/TabulateFusion_1_grad/TabulateFusionGrad
 4264.00	    4264	    4264	    0.07	load/gradients/filter_type_1/TabulateFusion_grad/TabulateFusionGrad
 4228.00	    4228	    4228	    0.07	load/gradients/filter_type_0/TabulateFusion_1_grad/TabulateFusionGrad
 3585.00	    3585	    3585	    0.06	load/gradients/layer_0_type_1/GemmTanhLayer_grad/MatmulNt
 3008.00	    3008	    3008	    0.05	load/layer_0_type_1/GemmTanhLayer
 2171.00	    2171	    2171	    0.04	load/gradients/layer_0_type_0/GemmTanhLayer_grad/MatmulNt
 2071.00	    2071	    2071	    0.04	load/gradients/filter_type_0/TabulateFusion_grad/TabulateFusionGrad
 1871.00	    1871	    1871	    0.03	load/filter_type_1/TabulateFusion_1
 1851.00	    1851	    1851	    0.03	load/ProdVirialSeA
 1659.00	    1659	    1659	    0.03	load/layer_0_type_0/GemmTanhLayer
 1061.00	    1061	    1061	    0.02	load/filter_type_1/TabulateFusion
 1000.00	    1000	    1000	    0.02	load/filter_type_0/TabulateFusion_1
  839.00	     839	     839	    0.01	load/filter_type_1/MatMul
  838.00	     838	     838	    0.01	load/ProdForceSeA
  602.00	     602	     602	    0.01	load/gradients/filter_type_1/MatMul_grad/MatMul
  514.00	     514	     514	    0.01	load/filter_type_0/TabulateFusion
  433.00	     433	     433	    0.01	load/filter_type_0/MatMul
  418.00	     418	     418	    0.01	load/layer_1_type_1/GemmTanhLayer
  408.00	     408	     408	    0.01	load/layer_2_type_1/GemmTanhLayer
  395.00	     395	     395	    0.01	load/gradients/layer_2_type_1/GemmTanhLayer_grad/MatmulNt
  395.00	     395	     395	    0.01	load/gradients/layer_1_type_1/GemmTanhLayer_grad/MatmulNt
  339.00	     339	     339	    0.01	load/concat
  323.00	     323	     323	    0.01	load/gradients/filter_type_0/MatMul_grad/MatMul
  317.00	     317	     317	    0.01	load/gradients/AddN_4
  283.00	     283	     283	    0.00	load/gradients/layer_2_type_0/GemmTanhLayer_grad/MatmulNt
  263.00	     263	     263	    0.00	load/gradients/Slice_3_grad/Pad
  257.00	     257	     257	    0.00	load/gradients/layer_1_type_0/GemmTanhLayer_grad/MatmulNt
  256.00	     256	     256	    0.00	load/gradients/filter_type_1/Slice_3_grad/Pad
  238.00	     238	     238	    0.00	load/layer_1_type_0/GemmTanhLayer
  237.00	     237	     237	    0.00	load/layer_2_type_0/GemmTanhLayer
  232.00	     232	     232	    0.00	load/gradients/Slice_2_grad/Pad
  227.00	     227	     227	    0.00	load/gradients/concat_grad/Slice_1
  222.00	     222	     222	    0.00	load/Slice_3
  215.00	     215	     215	    0.00	load/gradients/filter_type_1/MatMul_grad/MatMul_1
  167.00	     167	     167	    0.00	load/filter_type_1/Slice_3
  137.00	     137	     137	    0.00	load/gradients/filter_type_1/Slice_1_grad/Pad
  134.00	     134	     134	    0.00	load/gradients/filter_type_0/Slice_3_grad/Pad
  122.00	     122	     122	    0.00	load/gradients/filter_type_0/MatMul_grad/MatMul_1
  119.00	     119	     119	    0.00	load/Slice_2
  119.00	     119	     119	    0.00	load/gradients/concat_grad/Slice
   89.00	      89	      89	    0.00	load/filter_type_0/Slice_3
   88.00	      88	      88	    0.00	load/filter_type_1/Slice_1
   82.00	      82	      82	    0.00	load/gradients/AddN_13
   75.00	      75	      75	    0.00	load/gradients/Slice_1_grad/Pad
   73.00	      73	      73	    0.00	load/gradients/filter_type_0/Slice_1_grad/Pad
   68.00	      68	      68	    0.00	load/Slice_1
   68.00	      68	      68	    0.00	load/gradients/Slice_grad/Pad
   66.00	      66	      66	    0.00	load/filter_type_1/add
   65.00	      65	      65	    0.00	load/layer_1_type_1/mul
   60.00	      60	      60	    0.00	load/gradients/AddN_12
   58.00	      58	      58	    0.00	load/gradients/layer_2_type_1/mul_grad/Mul
   57.00	      57	      57	    0.00	load/layer_2_type_1/mul
   57.00	      57	      57	    0.00	load/gradients/filter_type_1/Slice_4_grad/Pad
   56.00	      56	      56	    0.00	load/gradients/layer_1_type_1/mul_grad/Mul
   55.00	      55	      55	    0.00	load/gradients/AddN_6
   53.00	      53	      53	    0.00	load/filter_type_1/Slice_4
   53.00	      53	      53	    0.00	load/gradients/filter_type_1/Slice_2_grad/Pad
   53.00	      53	      53	    0.00	load/gradients/filter_type_1/Slice_grad/Pad
   50.00	      50	      50	    0.00	load/filter_type_1/Slice_2
   48.00	      48	      48	    0.00	load/gradients/layer_2_type_0/mul_grad/Mul
   47.00	      47	      47	    0.00	load/filter_type_0/Slice_1
   46.00	      46	      46	    0.00	load/final_layer_type_1/GemmLayer
   42.00	      42	      42	    0.00	load/filter_type_1/mul
   42.00	      42	      42	    0.00	load/layer_1_type_0/mul
   42.00	      42	      42	    0.00	load/gradients/filter_type_1/mul_grad/Mul
   39.00	      39	      39	    0.00	load/Slice
   39.00	      39	      39	    0.00	load/gradients/AddN_10
   36.00	      36	      36	    0.00	load/filter_type_0/add
   36.00	      36	      36	    0.00	load/gradients/layer_1_type_0/mul_grad/Mul
   35.00	      35	      35	    0.00	load/filter_type_1/Slice
   35.00	      35	      35	    0.00	load/layer_2_type_0/mul
   34.00	      34	      34	    0.00	load/filter_type_0/Slice_4
   34.00	      34	      34	    0.00	load/gradients/layer_0_type_1/GemmTanhLayer_grad/Square
   34.00	      34	      34	    0.00	load/gradients/final_layer_type_0/GemmLayer_grad/MatmulNt
   34.00	      34	      34	    0.00	load/gradients/filter_type_0/Slice_4_grad/Pad
   32.00	      32	      32	    0.00	load/gradients/filter_type_0/Slice_grad/Pad
   31.00	      31	      31	    0.00	load/gradients/filter_type_0/Slice_2_grad/Pad
   30.00	      30	      30	    0.00	load/filter_type_0/Slice_2
   30.00	      30	      30	    0.00	load/gradients/final_layer_type_1/GemmLayer_grad/MatmulNt
   30.00	      30	      30	    0.00	load/gradients/AddN_1
   30.00	      30	      30	    0.00	load/gradients/AddN_11
   29.00	      29	      29	    0.00	load/gradients/layer_2_type_1/GemmTanhLayer_grad/mul
   29.00	      29	      29	    0.00	load/gradients/layer_1_type_1/GemmTanhLayer_grad/mul
   29.00	      29	      29	    0.00	load/gradients/layer_0_type_1/GemmTanhLayer_grad/mul
   28.00	      28	      28	    0.00	load/final_layer_type_0/GemmLayer
   28.00	      28	      28	    0.00	load/gradients/AddN_3
   28.00	      28	      28	    0.00	load/gradients/AddN_5
   27.00	      27	      27	    0.00	load/add_5
   27.00	      27	      27	    0.00	load/add_6
   23.00	      23	      23	    0.00	load/filter_type_0/mul
   23.00	      23	      23	    0.00	load/gradients/layer_0_type_1/GemmTanhLayer_grad/sub
   23.00	      23	      23	    0.00	load/gradients/filter_type_0/mul_grad/Mul
   22.00	      22	      22	    0.00	load/gradients/AddN_9
   21.00	      21	      21	    0.00	load/gradients/AddN_8
   20.00	      20	      20	    0.00	load/filter_type_0/Slice
   18.00	      18	      18	    0.00	load/strided_slice_32
   17.00	      17	      17	    0.00	load/strided_slice_30
   17.00	      17	      17	    0.00	load/gradients/AddN
   17.00	      17	      17	    0.00	load/gradients/AddN_2

Top k op type
average time	percentage	op type
18675.00	    0.33	TabulateFusionGrad
 9602.00	    0.17	ProdEnvMatA
 7150.00	    0.12	MatmulNt
 5968.00	    0.10	GemmTanhLayer
 4446.00	    0.08	TabulateFusion
 2534.00	    0.04	MatMul
 1851.00	    0.03	ProdVirialSeA
 1498.00	    0.03	Pad
 1424.00	    0.02	Slice
  838.00	    0.01	ProdForceSeA
  759.00	    0.01	AddN
  457.00	    0.01	concat
  448.00	    0.01	mul
  263.00	    0.00	Mul
  214.00	    0.00	Shape
  201.00	    0.00	Reshape
  196.00	    0.00	add
  111.00	    0.00	strided
  104.00	    0.00	sub
   78.00	    0.00	shape
