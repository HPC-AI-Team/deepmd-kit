WARNING:tensorflow:From /home/hp200266/u01036/gzq/fj_software/tensorflow/TensorFlow-2.2.0/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
OMP: Warning #181: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined
WARNING:tensorflow:From /home/hp200266/u01036/gzq/fj_software/tensorflow/TensorFlow-2.2.0/lib/python3.8/site-packages/tensorflow/python/profiler/internal/flops_registry.py:142: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
DEEPMD WARNING From /home/hp200266/u01036/gzq/fj_software/tensorflow/TensorFlow-2.2.0/lib/python3.8/site-packages/tensorflow/python/profiler/internal/flops_registry.py:142: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
73 ops no flops stats due to incomplete shapes.
DEEPMD INFO    # ---------------output of dp test--------------- 
DEEPMD INFO    # testing system : ../data/data_3
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Parsing Inputs...
generating trace file.

******************************************************
Timeline file is written to ./profiler.json_0.
Open a Chrome browser, enter URL chrome://tracing and load the timeline file.
******************************************************
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.

=========================Options=============================
-max_depth                  10
-min_bytes                  0
-min_peak_bytes             0
-min_residual_bytes         0
-min_output_bytes           0
-min_micros                 0
-min_accelerator_micros     0
-min_cpu_micros             0
-min_params                 0
-min_float_ops              0
-min_occurrence             0
-step                       -1
-order_by                   micros
-account_type_regexes       .*
-start_name_regexes         .*
-trim_name_regexes          
-show_name_regexes          .*
-hide_name_regexes          
-account_displayed_op_only  false
-select                     bytes,float_ops,micros,occurrence
-output                     stdout:

==================Model Analysis Report======================

Doc:
op: The nodes are operation kernel type, such as MatMul, Conv2D. Graph nodes belonging to the same type are aggregated together.
requested bytes: The memory requested by the operation, accumulatively.
flops: Number of float operations. Note: Please read the implementation for the math behind it.
total execution time: Sum of accelerator execution time and cpu execution time.
cpu execution time: The time from the start to the end of the operation. It's the sum of actual cpu run time plus the time that it spends waiting if part of computation is launched asynchronously.
accelerator execution time: Time spent executing on the accelerator. This is normally measured by the actual hardware library.
occurrence: The number of times it occurs

Profile:
node name | requested bytes | total execution time | accelerator execution time | cpu execution time | # float_ops | op occurrence (run|defined)
TabulateFusionGrad              1.06MB (100.00%, 1.25%),      10.80ms (100.00%, 21.90%),             0us (0.00%, 0.00%),      10.80ms (100.00%, 21.90%),   0 float_ops (100.00%, 0.00%),        4|4
ProdEnvMatA                      4.13MB (98.75%, 4.88%),        9.67ms (78.10%, 19.61%),             0us (0.00%, 0.00%),        9.67ms (78.10%, 19.61%),   0 float_ops (100.00%, 0.00%),        1|1
MatmulNt                         4.25MB (93.86%, 5.02%),        7.10ms (58.49%, 14.40%),             0us (0.00%, 0.00%),        7.10ms (58.49%, 14.40%),   0 float_ops (100.00%, 0.00%),        8|8
GemmTanhLayer                    1.11MB (88.84%, 1.31%),        5.96ms (44.09%, 12.08%),             0us (0.00%, 0.00%),        5.96ms (44.09%, 12.08%),   0 float_ops (100.00%, 0.00%),        6|6
TabulateFusion                   1.57MB (87.53%, 1.86%),         4.50ms (32.01%, 9.13%),             0us (0.00%, 0.00%),         4.50ms (32.01%, 9.13%),   0 float_ops (100.00%, 0.00%),        4|4
BatchMatMulV2                    4.03MB (85.67%, 4.76%),         2.29ms (22.88%, 4.64%),             0us (0.00%, 0.00%),         2.29ms (22.88%, 4.64%), 106.95m float_ops (100.00%, 98.52%),        6|6
ProdVirialSeA                   13.90KB (80.91%, 0.02%),         1.84ms (18.23%, 3.74%),             0us (0.00%, 0.00%),         1.84ms (18.23%, 3.74%),     0 float_ops (1.48%, 0.00%),        1|1
Pad                            11.32MB (80.89%, 13.37%),         1.49ms (14.49%, 3.03%),             0us (0.00%, 0.00%),         1.49ms (14.49%, 3.03%),     0 float_ops (1.48%, 0.00%),      14|14
Slice                            8.30MB (67.52%, 9.81%),         1.43ms (11.46%, 2.89%),             0us (0.00%, 0.00%),         1.43ms (11.46%, 2.89%),     0 float_ops (1.48%, 0.00%),      18|18
ProdForceSeA                     4.61KB (57.71%, 0.01%),           839us (8.57%, 1.70%),             0us (0.00%, 0.00%),           839us (8.57%, 1.70%),     0 float_ops (1.48%, 0.00%),        1|1
AddN                                  0B (0.00%, 0.00%),           756us (6.87%, 1.53%),             0us (0.00%, 0.00%),           756us (6.87%, 1.53%), 809.47k float_ops (1.48%, 0.75%),      14|14

======================End of Report==========================
DEEPMD INFO    # number of test data : 1 
DEEPMD INFO    Energy RMSE        : 6.076734e-02 eV
DEEPMD INFO    Energy RMSE/Natoms : 3.164966e-04 eV
DEEPMD INFO    Force  RMSE        : 6.465624e-02 eV/A
DEEPMD INFO    Virial RMSE        : 5.265184e+00 eV
DEEPMD INFO    Virial RMSE/Natoms : 2.742283e-02 eV
DEEPMD INFO    # ----------------------------------------------- 
profile : ture
dp model type : ener
OMP: Warning #181: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined
INFO: You are running LIKWID in a cpuset with 50 CPUs. Taking given IDs as logical ID in cpuset
[1;34m[likwid-pin] Main PID -> hwthread 12 - OK[0m

Top k op
average time	min time	max time	percentage	op name
 9669.00	    9669	    9669	    0.20	load/ProdEnvMatA
 4673.00	    4673	    4673	    0.10	load/gradients/filter_type_1/TabulateFusion_1_grad/TabulateFusionGrad
 3569.00	    3569	    3569	    0.07	load/gradients/layer_0_type_1/GemmTanhLayer_grad/MatmulNt
 3001.00	    3001	    3001	    0.06	load/layer_0_type_1/GemmTanhLayer
 2492.00	    2492	    2492	    0.05	load/gradients/filter_type_1/TabulateFusion_grad/TabulateFusionGrad
 2432.00	    2432	    2432	    0.05	load/gradients/filter_type_0/TabulateFusion_1_grad/TabulateFusionGrad
 2154.00	    2154	    2154	    0.04	load/gradients/layer_0_type_0/GemmTanhLayer_grad/MatmulNt
 1887.00	    1887	    1887	    0.04	load/filter_type_1/TabulateFusion_1
 1844.00	    1844	    1844	    0.04	load/ProdVirialSeA
 1654.00	    1654	    1654	    0.03	load/layer_0_type_0/GemmTanhLayer
 1201.00	    1201	    1201	    0.02	load/gradients/filter_type_0/TabulateFusion_grad/TabulateFusionGrad
 1084.00	    1084	    1084	    0.02	load/filter_type_1/TabulateFusion
 1010.00	    1010	    1010	    0.02	load/filter_type_0/TabulateFusion_1
  839.00	     839	     839	    0.02	load/ProdForceSeA
  752.00	     752	     752	    0.02	load/filter_type_1/MatMul
  546.00	     546	     546	    0.01	load/gradients/filter_type_1/MatMul_grad/MatMul
  523.00	     523	     523	    0.01	load/filter_type_0/TabulateFusion
  419.00	     419	     419	    0.01	load/layer_1_type_1/GemmTanhLayer
  408.00	     408	     408	    0.01	load/layer_2_type_1/GemmTanhLayer
  392.00	     392	     392	    0.01	load/gradients/layer_2_type_1/GemmTanhLayer_grad/MatmulNt
  391.00	     391	     391	    0.01	load/gradients/layer_1_type_1/GemmTanhLayer_grad/MatmulNt
  389.00	     389	     389	    0.01	load/filter_type_0/MatMul
  339.00	     339	     339	    0.01	load/concat
  319.00	     319	     319	    0.01	load/gradients/AddN_4
  278.00	     278	     278	    0.01	load/gradients/layer_2_type_0/GemmTanhLayer_grad/MatmulNt
  274.00	     274	     274	    0.01	load/gradients/filter_type_0/MatMul_grad/MatMul
  259.00	     259	     259	    0.01	load/gradients/Slice_3_grad/Pad
  257.00	     257	     257	    0.01	load/gradients/filter_type_1/Slice_3_grad/Pad
  256.00	     256	     256	    0.01	load/gradients/layer_1_type_0/GemmTanhLayer_grad/MatmulNt
  239.00	     239	     239	    0.00	load/layer_1_type_0/GemmTanhLayer
  234.00	     234	     234	    0.00	load/layer_2_type_0/GemmTanhLayer
  231.00	     231	     231	    0.00	load/gradients/Slice_2_grad/Pad
  227.00	     227	     227	    0.00	load/gradients/concat_grad/Slice_1
  223.00	     223	     223	    0.00	load/Slice_3
  206.00	     206	     206	    0.00	load/gradients/filter_type_1/MatMul_grad/MatMul_1
  162.00	     162	     162	    0.00	load/filter_type_1/Slice_3
  137.00	     137	     137	    0.00	load/gradients/filter_type_1/Slice_1_grad/Pad
  136.00	     136	     136	    0.00	load/gradients/filter_type_0/Slice_3_grad/Pad
  123.00	     123	     123	    0.00	load/gradients/filter_type_0/MatMul_grad/MatMul_1
  119.00	     119	     119	    0.00	load/gradients/concat_grad/Slice
  118.00	     118	     118	    0.00	load/Slice_2
   94.00	      94	      94	    0.00	load/filter_type_1/Slice_1
   89.00	      89	      89	    0.00	load/filter_type_0/Slice_3
   89.00	      89	      89	    0.00	load/gradients/AddN_13
   77.00	      77	      77	    0.00	load/gradients/Slice_1_grad/Pad
   73.00	      73	      73	    0.00	load/gradients/filter_type_0/Slice_1_grad/Pad
   72.00	      72	      72	    0.00	load/gradients/Slice_grad/Pad
   68.00	      68	      68	    0.00	load/Slice_1
   65.00	      65	      65	    0.00	load/filter_type_1/add
   64.00	      64	      64	    0.00	load/layer_1_type_1/mul
   58.00	      58	      58	    0.00	load/gradients/filter_type_1/Slice_4_grad/Pad
   57.00	      57	      57	    0.00	load/gradients/layer_2_type_1/mul_grad/Mul
   56.00	      56	      56	    0.00	load/gradients/layer_1_type_1/mul_grad/Mul
   56.00	      56	      56	    0.00	load/gradients/AddN_12
   55.00	      55	      55	    0.00	load/layer_2_type_1/mul
   54.00	      54	      54	    0.00	load/filter_type_1/Slice_4
   54.00	      54	      54	    0.00	load/gradients/AddN_6
   51.00	      51	      51	    0.00	load/filter_type_1/Slice_2
   51.00	      51	      51	    0.00	load/gradients/filter_type_1/Slice_2_grad/Pad
   48.00	      48	      48	    0.00	load/gradients/filter_type_1/Slice_grad/Pad
   45.00	      45	      45	    0.00	load/filter_type_0/Slice_1
   45.00	      45	      45	    0.00	load/final_layer_type_1/GemmLayer
   44.00	      44	      44	    0.00	load/gradients/layer_2_type_0/mul_grad/Mul
   42.00	      42	      42	    0.00	load/filter_type_1/mul
   41.00	      41	      41	    0.00	load/layer_1_type_0/mul
   41.00	      41	      41	    0.00	load/gradients/filter_type_1/mul_grad/Mul
   39.00	      39	      39	    0.00	load/Slice
   38.00	      38	      38	    0.00	load/gradients/AddN_10
   36.00	      36	      36	    0.00	load/filter_type_0/add
   36.00	      36	      36	    0.00	load/gradients/layer_1_type_0/mul_grad/Mul
   34.00	      34	      34	    0.00	load/gradients/layer_0_type_1/GemmTanhLayer_grad/Square
   34.00	      34	      34	    0.00	load/layer_2_type_0/mul
   33.00	      33	      33	    0.00	load/filter_type_0/Slice_4
   33.00	      33	      33	    0.00	load/filter_type_1/Slice
   33.00	      33	      33	    0.00	load/gradients/final_layer_type_0/GemmLayer_grad/MatmulNt
   32.00	      32	      32	    0.00	load/gradients/filter_type_0/Slice_4_grad/Pad
   31.00	      31	      31	    0.00	load/filter_type_0/Slice_2
   31.00	      31	      31	    0.00	load/gradients/filter_type_0/Slice_grad/Pad
   30.00	      30	      30	    0.00	load/gradients/filter_type_0/Slice_2_grad/Pad
   30.00	      30	      30	    0.00	load/gradients/AddN_11
   29.00	      29	      29	    0.00	load/final_layer_type_0/GemmLayer
   29.00	      29	      29	    0.00	load/gradients/final_layer_type_1/GemmLayer_grad/MatmulNt
   29.00	      29	      29	    0.00	load/gradients/layer_2_type_1/GemmTanhLayer_grad/mul
   29.00	      29	      29	    0.00	load/gradients/AddN_1
   28.00	      28	      28	    0.00	load/gradients/layer_1_type_1/GemmTanhLayer_grad/mul
   28.00	      28	      28	    0.00	load/gradients/layer_0_type_1/GemmTanhLayer_grad/mul
   27.00	      27	      27	    0.00	load/add_5
   27.00	      27	      27	    0.00	load/add_6
   27.00	      27	      27	    0.00	load/gradients/AddN_3
   27.00	      27	      27	    0.00	load/gradients/AddN_5
   23.00	      23	      23	    0.00	load/filter_type_0/mul
   23.00	      23	      23	    0.00	load/gradients/filter_type_0/mul_grad/Mul
   22.00	      22	      22	    0.00	load/gradients/layer_0_type_1/GemmTanhLayer_grad/sub
   21.00	      21	      21	    0.00	load/filter_type_0/Slice
   21.00	      21	      21	    0.00	load/gradients/AddN_9
   21.00	      21	      21	    0.00	load/gradients/AddN_8
   18.00	      18	      18	    0.00	load/strided_slice_30
   17.00	      17	      17	    0.00	load/add_2
   17.00	      17	      17	    0.00	load/gradients/AddN
   16.00	      16	      16	    0.00	load/add_3

Top k op type
average time	percentage	op type
10798.00	    0.22	TabulateFusionGrad
 9669.00	    0.20	ProdEnvMatA
 7102.00	    0.14	MatmulNt
 5955.00	    0.12	GemmTanhLayer
 4504.00	    0.09	TabulateFusion
 2290.00	    0.05	MatMul
 1844.00	    0.04	ProdVirialSeA
 1492.00	    0.03	Pad
 1425.00	    0.03	Slice
  839.00	    0.02	ProdForceSeA
  756.00	    0.02	AddN
  453.00	    0.01	concat
  441.00	    0.01	mul
  257.00	    0.01	Mul
  214.00	    0.00	Shape
  197.00	    0.00	Reshape
  195.00	    0.00	add
   99.00	    0.00	sub
   97.00	    0.00	strided
   80.00	    0.00	shape
