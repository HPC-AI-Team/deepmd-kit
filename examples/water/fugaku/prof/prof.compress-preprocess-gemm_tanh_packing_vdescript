WARNING:tensorflow:From /home/hp200266/u01036/gzq/fj_software/tensorflow/TensorFlow-2.2.0/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
OMP: Warning #181: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined
WARNING:tensorflow:From /home/hp200266/u01036/gzq/fj_software/tensorflow/TensorFlow-2.2.0/lib/python3.8/site-packages/tensorflow/python/profiler/internal/flops_registry.py:142: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
DEEPMD WARNING From /home/hp200266/u01036/gzq/fj_software/tensorflow/TensorFlow-2.2.0/lib/python3.8/site-packages/tensorflow/python/profiler/internal/flops_registry.py:142: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
73 ops no flops stats due to incomplete shapes.
DEEPMD INFO    # ---------------output of dp test--------------- 
DEEPMD INFO    # testing system : ../data/data_3
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Parsing Inputs...
generating trace file.

******************************************************
Timeline file is written to ./profiler.json_0.
Open a Chrome browser, enter URL chrome://tracing and load the timeline file.
******************************************************
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.
Incomplete shape.

=========================Options=============================
-max_depth                  10
-min_bytes                  0
-min_peak_bytes             0
-min_residual_bytes         0
-min_output_bytes           0
-min_micros                 0
-min_accelerator_micros     0
-min_cpu_micros             0
-min_params                 0
-min_float_ops              0
-min_occurrence             0
-step                       -1
-order_by                   micros
-account_type_regexes       .*
-start_name_regexes         .*
-trim_name_regexes          
-show_name_regexes          .*
-hide_name_regexes          
-account_displayed_op_only  false
-select                     bytes,float_ops,micros,occurrence
-output                     stdout:

==================Model Analysis Report======================

Doc:
op: The nodes are operation kernel type, such as MatMul, Conv2D. Graph nodes belonging to the same type are aggregated together.
requested bytes: The memory requested by the operation, accumulatively.
flops: Number of float operations. Note: Please read the implementation for the math behind it.
total execution time: Sum of accelerator execution time and cpu execution time.
cpu execution time: The time from the start to the end of the operation. It's the sum of actual cpu run time plus the time that it spends waiting if part of computation is launched asynchronously.
accelerator execution time: Time spent executing on the accelerator. This is normally measured by the actual hardware library.
occurrence: The number of times it occurs

Profile:
node name | requested bytes | total execution time | accelerator execution time | cpu execution time | # float_ops | op occurrence (run|defined)
TabulateFusionGrad              1.06MB (100.00%, 1.25%),      10.83ms (100.00%, 21.86%),             0us (0.00%, 0.00%),      10.83ms (100.00%, 21.86%),   0 float_ops (100.00%, 0.00%),        4|4
ProdEnvMatA                      4.13MB (98.75%, 4.88%),        9.67ms (78.14%, 19.53%),             0us (0.00%, 0.00%),        9.67ms (78.14%, 19.53%),   0 float_ops (100.00%, 0.00%),        1|1
MatmulNt                         4.25MB (93.86%, 5.02%),        7.04ms (58.61%, 14.22%),             0us (0.00%, 0.00%),        7.04ms (58.61%, 14.22%),   0 float_ops (100.00%, 0.00%),        8|8
GemmTanhLayer                    1.11MB (88.84%, 1.31%),        5.97ms (44.39%, 12.05%),             0us (0.00%, 0.00%),        5.97ms (44.39%, 12.05%),   0 float_ops (100.00%, 0.00%),        6|6
TabulateFusion                   1.57MB (87.53%, 1.86%),         4.56ms (32.34%, 9.21%),             0us (0.00%, 0.00%),         4.56ms (32.34%, 9.21%),   0 float_ops (100.00%, 0.00%),        4|4
BatchMatMulV2                    4.03MB (85.67%, 4.76%),         2.47ms (23.13%, 4.99%),             0us (0.00%, 0.00%),         2.47ms (23.13%, 4.99%), 106.95m float_ops (100.00%, 98.52%),        6|6
ProdVirialSeA                   13.90KB (80.91%, 0.02%),         1.85ms (18.15%, 3.73%),             0us (0.00%, 0.00%),         1.85ms (18.15%, 3.73%),     0 float_ops (1.48%, 0.00%),        1|1
Pad                            11.32MB (80.89%, 13.37%),         1.50ms (14.42%, 3.02%),             0us (0.00%, 0.00%),         1.50ms (14.42%, 3.02%),     0 float_ops (1.48%, 0.00%),      14|14
Slice                            8.30MB (67.52%, 9.81%),         1.42ms (11.39%, 2.86%),             0us (0.00%, 0.00%),         1.42ms (11.39%, 2.86%),     0 float_ops (1.48%, 0.00%),      18|18
ProdForceSeA                     4.61KB (57.71%, 0.01%),           838us (8.54%, 1.69%),             0us (0.00%, 0.00%),           838us (8.54%, 1.69%),     0 float_ops (1.48%, 0.00%),        1|1
AddN                                  0B (0.00%, 0.00%),           759us (6.84%, 1.53%),             0us (0.00%, 0.00%),           759us (6.84%, 1.53%), 809.47k float_ops (1.48%, 0.75%),      14|14

======================End of Report==========================
DEEPMD INFO    # number of test data : 1 
DEEPMD INFO    Energy RMSE        : 6.076734e-02 eV
DEEPMD INFO    Energy RMSE/Natoms : 3.164966e-04 eV
DEEPMD INFO    Force  RMSE        : 6.465624e-02 eV/A
DEEPMD INFO    Virial RMSE        : 5.265184e+00 eV
DEEPMD INFO    Virial RMSE/Natoms : 2.742283e-02 eV
DEEPMD INFO    # ----------------------------------------------- 
profile : ture
dp model type : ener
OMP: Warning #181: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined
INFO: You are running LIKWID in a cpuset with 50 CPUs. Taking given IDs as logical ID in cpuset
[1;34m[likwid-pin] Main PID -> hwthread 12 - OK[0m

Top k op
average time	min time	max time	percentage	op name
 9673.00	    9673	    9673	    0.20	load/ProdEnvMatA
 4671.00	    4671	    4671	    0.09	load/gradients/filter_type_1/TabulateFusion_1_grad/TabulateFusionGrad
 3555.00	    3555	    3555	    0.07	load/gradients/layer_0_type_1/GemmTanhLayer_grad/MatmulNt
 3007.00	    3007	    3007	    0.06	load/layer_0_type_1/GemmTanhLayer
 2508.00	    2508	    2508	    0.05	load/gradients/filter_type_1/TabulateFusion_grad/TabulateFusionGrad
 2445.00	    2445	    2445	    0.05	load/gradients/filter_type_0/TabulateFusion_1_grad/TabulateFusionGrad
 2100.00	    2100	    2100	    0.04	load/gradients/layer_0_type_0/GemmTanhLayer_grad/MatmulNt
 1930.00	    1930	    1930	    0.04	load/filter_type_1/TabulateFusion_1
 1846.00	    1846	    1846	    0.04	load/ProdVirialSeA
 1659.00	    1659	    1659	    0.03	load/layer_0_type_0/GemmTanhLayer
 1205.00	    1205	    1205	    0.02	load/gradients/filter_type_0/TabulateFusion_grad/TabulateFusionGrad
 1089.00	    1089	    1089	    0.02	load/filter_type_1/TabulateFusion
 1015.00	    1015	    1015	    0.02	load/filter_type_0/TabulateFusion_1
  838.00	     838	     838	    0.02	load/ProdForceSeA
  834.00	     834	     834	    0.02	load/filter_type_1/MatMul
  619.00	     619	     619	    0.01	load/gradients/filter_type_1/MatMul_grad/MatMul
  527.00	     527	     527	    0.01	load/filter_type_0/TabulateFusion
  420.00	     420	     420	    0.01	load/layer_1_type_1/GemmTanhLayer
  406.00	     406	     406	    0.01	load/layer_2_type_1/GemmTanhLayer
  395.00	     395	     395	    0.01	load/gradients/layer_2_type_1/GemmTanhLayer_grad/MatmulNt
  392.00	     392	     392	    0.01	load/gradients/layer_1_type_1/GemmTanhLayer_grad/MatmulNt
  388.00	     388	     388	    0.01	load/filter_type_0/MatMul
  337.00	     337	     337	    0.01	load/concat
  318.00	     318	     318	    0.01	load/gradients/AddN_4
  287.00	     287	     287	    0.01	load/gradients/filter_type_0/MatMul_grad/MatMul
  277.00	     277	     277	    0.01	load/gradients/layer_2_type_0/GemmTanhLayer_grad/MatmulNt
  260.00	     260	     260	    0.01	load/gradients/Slice_3_grad/Pad
  258.00	     258	     258	    0.01	load/gradients/layer_1_type_0/GemmTanhLayer_grad/MatmulNt
  258.00	     258	     258	    0.01	load/gradients/filter_type_1/Slice_3_grad/Pad
  240.00	     240	     240	    0.00	load/layer_1_type_0/GemmTanhLayer
  235.00	     235	     235	    0.00	load/layer_2_type_0/GemmTanhLayer
  232.00	     232	     232	    0.00	load/gradients/Slice_2_grad/Pad
  227.00	     227	     227	    0.00	load/gradients/concat_grad/Slice_1
  224.00	     224	     224	    0.00	load/gradients/filter_type_1/MatMul_grad/MatMul_1
  223.00	     223	     223	    0.00	load/Slice_3
  164.00	     164	     164	    0.00	load/filter_type_1/Slice_3
  138.00	     138	     138	    0.00	load/gradients/filter_type_1/Slice_1_grad/Pad
  136.00	     136	     136	    0.00	load/gradients/filter_type_0/Slice_3_grad/Pad
  119.00	     119	     119	    0.00	load/gradients/concat_grad/Slice
  118.00	     118	     118	    0.00	load/Slice_2
  117.00	     117	     117	    0.00	load/gradients/filter_type_0/MatMul_grad/MatMul_1
   90.00	      90	      90	    0.00	load/gradients/AddN_13
   88.00	      88	      88	    0.00	load/filter_type_1/Slice_1
   84.00	      84	      84	    0.00	load/filter_type_0/Slice_3
   78.00	      78	      78	    0.00	load/gradients/Slice_1_grad/Pad
   74.00	      74	      74	    0.00	load/gradients/filter_type_0/Slice_1_grad/Pad
   72.00	      72	      72	    0.00	load/gradients/Slice_grad/Pad
   68.00	      68	      68	    0.00	load/Slice_1
   65.00	      65	      65	    0.00	load/layer_1_type_1/mul
   64.00	      64	      64	    0.00	load/filter_type_1/add
   58.00	      58	      58	    0.00	load/gradients/filter_type_1/Slice_4_grad/Pad
   57.00	      57	      57	    0.00	load/layer_2_type_1/mul
   57.00	      57	      57	    0.00	load/gradients/layer_2_type_1/mul_grad/Mul
   56.00	      56	      56	    0.00	load/gradients/layer_1_type_1/mul_grad/Mul
   56.00	      56	      56	    0.00	load/gradients/AddN_12
   54.00	      54	      54	    0.00	load/gradients/AddN_6
   52.00	      52	      52	    0.00	load/filter_type_1/Slice_4
   51.00	      51	      51	    0.00	load/filter_type_1/Slice_2
   51.00	      51	      51	    0.00	load/gradients/filter_type_1/Slice_2_grad/Pad
   48.00	      48	      48	    0.00	load/filter_type_0/Slice_1
   48.00	      48	      48	    0.00	load/gradients/filter_type_1/Slice_grad/Pad
   46.00	      46	      46	    0.00	load/final_layer_type_1/GemmLayer
   45.00	      45	      45	    0.00	load/gradients/layer_2_type_0/mul_grad/Mul
   42.00	      42	      42	    0.00	load/gradients/filter_type_1/mul_grad/Mul
   41.00	      41	      41	    0.00	load/filter_type_1/mul
   41.00	      41	      41	    0.00	load/layer_1_type_0/mul
   39.00	      39	      39	    0.00	load/Slice
   39.00	      39	      39	    0.00	load/gradients/AddN_10
   36.00	      36	      36	    0.00	load/layer_2_type_0/mul
   36.00	      36	      36	    0.00	load/gradients/layer_1_type_0/mul_grad/Mul
   35.00	      35	      35	    0.00	load/filter_type_0/add
   35.00	      35	      35	    0.00	load/gradients/layer_0_type_1/GemmTanhLayer_grad/Square
   34.00	      34	      34	    0.00	load/gradients/final_layer_type_0/GemmLayer_grad/MatmulNt
   33.00	      33	      33	    0.00	load/filter_type_1/Slice
   33.00	      33	      33	    0.00	load/gradients/filter_type_0/Slice_4_grad/Pad
   32.00	      32	      32	    0.00	load/filter_type_0/Slice_4
   31.00	      31	      31	    0.00	load/filter_type_0/Slice_2
   31.00	      31	      31	    0.00	load/gradients/final_layer_type_1/GemmLayer_grad/MatmulNt
   31.00	      31	      31	    0.00	load/gradients/filter_type_0/Slice_2_grad/Pad
   29.00	      29	      29	    0.00	load/gradients/layer_2_type_1/GemmTanhLayer_grad/mul
   29.00	      29	      29	    0.00	load/gradients/AddN_1
   29.00	      29	      29	    0.00	load/gradients/layer_1_type_1/GemmTanhLayer_grad/mul
   29.00	      29	      29	    0.00	load/gradients/filter_type_0/Slice_grad/Pad
   29.00	      29	      29	    0.00	load/gradients/AddN_11
   28.00	      28	      28	    0.00	load/add_5
   28.00	      28	      28	    0.00	load/final_layer_type_0/GemmLayer
   28.00	      28	      28	    0.00	load/gradients/layer_0_type_1/GemmTanhLayer_grad/mul
   28.00	      28	      28	    0.00	load/gradients/AddN_5
   27.00	      27	      27	    0.00	load/add_6
   27.00	      27	      27	    0.00	load/gradients/AddN_3
   23.00	      23	      23	    0.00	load/filter_type_0/mul
   23.00	      23	      23	    0.00	load/gradients/layer_0_type_1/GemmTanhLayer_grad/sub
   22.00	      22	      22	    0.00	load/gradients/filter_type_0/mul_grad/Mul
   21.00	      21	      21	    0.00	load/filter_type_0/Slice
   21.00	      21	      21	    0.00	load/gradients/AddN_9
   21.00	      21	      21	    0.00	load/gradients/AddN_8
   18.00	      18	      18	    0.00	load/strided_slice_30
   18.00	      18	      18	    0.00	load/gradients/AddN
   16.00	      16	      16	    0.00	load/add_2
   16.00	      16	      16	    0.00	load/gradients/AddN_2

Top k op type
average time	percentage	op type
10829.00	    0.22	TabulateFusionGrad
 9673.00	    0.20	ProdEnvMatA
 7042.00	    0.14	MatmulNt
 5967.00	    0.12	GemmTanhLayer
 4561.00	    0.09	TabulateFusion
 2469.00	    0.05	MatMul
 1846.00	    0.04	ProdVirialSeA
 1498.00	    0.03	Pad
 1415.00	    0.03	Slice
  838.00	    0.02	ProdForceSeA
  759.00	    0.02	AddN
  452.00	    0.01	concat
  448.00	    0.01	mul
  258.00	    0.01	Mul
  211.00	    0.00	Shape
  192.00	    0.00	add
  190.00	    0.00	Reshape
  102.00	    0.00	sub
   95.00	    0.00	strided
   77.00	    0.00	shape
